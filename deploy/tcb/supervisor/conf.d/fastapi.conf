; FastAPI Application Process Configuration
; Priority 300 - Starts after PostgreSQL and Redis

[program:fastapi]
command=/opt/venv/bin/python main.py
directory=/app
user=superinsight
autostart=true
autorestart=true
priority=300
startsecs=10
startretries=5
stopwaitsecs=30
stopsignal=TERM
redirect_stderr=true
stdout_logfile=/var/log/supervisor/fastapi.log
stdout_logfile_maxbytes=10MB
stdout_logfile_backups=3
environment=PYTHONPATH="/app",DATABASE_URL="postgresql://%(ENV_POSTGRES_USER)s:%(ENV_POSTGRES_PASSWORD)s@localhost:5432/%(ENV_POSTGRES_DB)s",REDIS_URL="redis://localhost:%(ENV_REDIS_PORT)s/0"

; Dependency on PostgreSQL and Redis
depends_on=postgres,redis
